# VR æ¸¸æˆå¹³å° - æ•°æ®åº“è®¾è®¡

## ä¸€ã€æ•°æ®åº“é€‰å‹ï¼šPostgreSQL

**é€‰æ‹©ç†ç”±**ï¼š

- âœ… ACID äº‹åŠ¡ä¿è¯
- âœ… æ”¯æŒ JSON/JSONB ç±»å‹
- âœ… å¼ºå¤§çš„å…¨æ–‡æœç´¢
- âœ… ä¸°å¯Œçš„ç´¢å¼•ç±»å‹
- âœ… ä¼˜ç§€çš„æ€§èƒ½å’Œæ‰©å±•æ€§

## äºŒã€ER å›¾

```
ç”¨æˆ·(User) 1 --- N æ¸¸æˆ(Game) [å¼€å‘å…³ç³»]
ç”¨æˆ·(User) 1 --- N è®¢å•(Order)
ç”¨æˆ·(User) 1 --- N è¯„è®º(Comment)
ç”¨æˆ·(User) 1 --- N å¸–å­(Post)
ç”¨æˆ·(User) N --- N ç”¨æˆ·(User) [å¥½å‹å…³ç³»]
ç”¨æˆ·(User) N --- N æ¸¸æˆ(Game) [æ¸¸æˆåº“]

æ¸¸æˆ(Game) 1 --- N è¯„è®º(Comment)
æ¸¸æˆ(Game) 1 --- N æ¸¸æˆåª’ä½“(GameMedia)
æ¸¸æˆ(Game) N --- N æ ‡ç­¾(Tag)
æ¸¸æˆ(Game) N --- 1 åˆ†ç±»(Category)

è®¢å•(Order) 1 --- N è®¢å•é¡¹(OrderItem)
å¸–å­(Post) 1 --- N å›å¤(PostReply)
å¸–å­(Post) N --- 1 è®ºå›æ¿å—(ForumSection)
```

## ä¸‰ã€æ•°æ®è¡¨è®¾è®¡

### 3.1 ç”¨æˆ·è¡¨ (users)

```sql
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    avatar VARCHAR(500),
    bio TEXT,
    role VARCHAR(20) DEFAULT 'user' CHECK (role IN ('user', 'developer', 'admin', 'moderator')),
    status VARCHAR(20) DEFAULT 'active' CHECK (status IN ('active', 'banned', 'pending')),
    email_verified BOOLEAN DEFAULT FALSE,
    total_play_time INTEGER DEFAULT 0,  -- æ€»æ¸¸æˆæ—¶é•¿(åˆ†é’Ÿ)
    games_owned INTEGER DEFAULT 0,      -- æ‹¥æœ‰æ¸¸æˆæ•°
    achievements_count INTEGER DEFAULT 0,
    level INTEGER DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login TIMESTAMP
);

CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);
CREATE INDEX idx_users_created_at ON users(created_at);
```

**TypeORM å®ä½“**ï¼š

```typescript
import {
  Entity,
  PrimaryGeneratedColumn,
  Column,
  CreateDateColumn,
  UpdateDateColumn,
} from "typeorm";

@Entity("users")
export class User {
  @PrimaryGeneratedColumn("uuid")
  id: string;

  @Column({ unique: true, length: 50 })
  username: string;

  @Column({ unique: true })
  email: string;

  @Column({ name: "password_hash" })
  passwordHash: string;

  @Column({ nullable: true, length: 500 })
  avatar?: string;

  @Column({ type: "text", nullable: true })
  bio?: string;

  @Column({ default: "user" })
  role: "user" | "developer" | "admin" | "moderator";

  @Column({ default: "active" })
  status: "active" | "banned" | "pending";

  @Column({ name: "email_verified", default: false })
  emailVerified: boolean;

  @Column({ name: "total_play_time", default: 0 })
  totalPlayTime: number;

  @Column({ name: "games_owned", default: 0 })
  gamesOwned: number;

  @Column({ name: "achievements_count", default: 0 })
  achievementsCount: number;

  @Column({ default: 1 })
  level: number;

  @CreateDateColumn({ name: "created_at" })
  createdAt: Date;

  @UpdateDateColumn({ name: "updated_at" })
  updatedAt: Date;

  @Column({ name: "last_login", nullable: true })
  lastLogin?: Date;
}
```

### 3.2 æ¸¸æˆè¡¨ (games)

```sql
CREATE TABLE games (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    title VARCHAR(200) NOT NULL,
    subtitle VARCHAR(200),
    slug VARCHAR(200) UNIQUE NOT NULL,
    developer_id UUID REFERENCES users(id) ON DELETE SET NULL,
    publisher VARCHAR(100),
    short_description TEXT,
    full_description TEXT,
    cover_image VARCHAR(500),
    trailer_video VARCHAR(500),
    category_id UUID REFERENCES categories(id),
    price DECIMAL(10, 2) DEFAULT 0,
    pricing_type VARCHAR(20) DEFAULT 'free' CHECK (pricing_type IN ('free', 'paid', 'subscription')),
    discount_price DECIMAL(10, 2),
    discount_end_date TIMESTAMP,
    rating FLOAT DEFAULT 0 CHECK (rating >= 0 AND rating <= 5),
    rating_count INTEGER DEFAULT 0,
    downloads INTEGER DEFAULT 0,
    views INTEGER DEFAULT 0,
    status VARCHAR(20) DEFAULT 'draft' CHECK (status IN ('draft', 'review', 'published', 'archived')),
    age_rating VARCHAR(10),
    supported_platforms JSONB,  -- ["Quest", "PSVR", "PC VR"]
    supported_languages JSONB,  -- ["zh-CN", "en", "ja"]
    features JSONB,             -- ["multiplayer", "chinese"]
    system_requirements JSONB,  -- {minimum: {...}, recommended: {...}}
    release_date DATE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    published_at TIMESTAMP
);

CREATE INDEX idx_games_title ON games(title);
CREATE INDEX idx_games_slug ON games(slug);
CREATE INDEX idx_games_developer ON games(developer_id);
CREATE INDEX idx_games_category ON games(category_id);
CREATE INDEX idx_games_rating ON games(rating DESC);
CREATE INDEX idx_games_downloads ON games(downloads DESC);
CREATE INDEX idx_games_price ON games(price);
CREATE INDEX idx_games_status ON games(status);
CREATE INDEX idx_games_created_at ON games(created_at DESC);
CREATE INDEX idx_games_category_rating ON games(category_id, rating DESC);
```

**TypeORM å®ä½“**ï¼š

```typescript
@Entity("games")
export class Game {
  @PrimaryGeneratedColumn("uuid")
  id: string;

  @Column({ length: 200 })
  title: string;

  @Column({ length: 200, nullable: true })
  subtitle?: string;

  @Column({ unique: true, length: 200 })
  slug: string;

  @ManyToOne(() => User)
  @JoinColumn({ name: "developer_id" })
  developer: User;

  @Column({ nullable: true })
  publisher?: string;

  @Column({ type: "text", name: "short_description" })
  shortDescription: string;

  @Column({ type: "text", name: "full_description" })
  fullDescription: string;

  @Column({ name: "cover_image", length: 500 })
  coverImage: string;

  @Column({ name: "trailer_video", nullable: true })
  trailerVideo?: string;

  @ManyToOne(() => Category)
  @JoinColumn({ name: "category_id" })
  category: Category;

  @Column({ type: "decimal", precision: 10, scale: 2, default: 0 })
  price: number;

  @Column({ name: "pricing_type", default: "free" })
  pricingType: "free" | "paid" | "subscription";

  @Column({
    name: "discount_price",
    type: "decimal",
    precision: 10,
    scale: 2,
    nullable: true,
  })
  discountPrice?: number;

  @Column({ name: "discount_end_date", nullable: true })
  discountEndDate?: Date;

  @Column({ type: "float", default: 0 })
  rating: number;

  @Column({ name: "rating_count", default: 0 })
  ratingCount: number;

  @Column({ default: 0 })
  downloads: number;

  @Column({ default: 0 })
  views: number;

  @Column({ default: "draft" })
  status: "draft" | "review" | "published" | "archived";

  @Column({ name: "age_rating", nullable: true })
  ageRating?: string;

  @Column({ name: "supported_platforms", type: "jsonb" })
  supportedPlatforms: string[];

  @Column({ name: "supported_languages", type: "jsonb" })
  supportedLanguages: string[];

  @Column({ type: "jsonb", nullable: true })
  features?: string[];

  @Column({ name: "system_requirements", type: "jsonb" })
  systemRequirements: {
    minimum: SystemReq;
    recommended: SystemReq;
  };

  @Column({ name: "release_date", type: "date" })
  releaseDate: Date;

  @CreateDateColumn({ name: "created_at" })
  createdAt: Date;

  @UpdateDateColumn({ name: "updated_at" })
  updatedAt: Date;

  @Column({ name: "published_at", nullable: true })
  publishedAt?: Date;

  @OneToMany(() => Comment, (comment) => comment.game)
  comments: Comment[];

  @OneToMany(() => GameMedia, (media) => media.game)
  media: GameMedia[];

  @ManyToMany(() => Tag)
  @JoinTable({
    name: "game_tags",
    joinColumn: { name: "game_id" },
    inverseJoinColumn: { name: "tag_id" },
  })
  tags: Tag[];
}
```

### 3.3 åˆ†ç±»è¡¨ (categories)

```sql
CREATE TABLE categories (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(50) UNIQUE NOT NULL,
    slug VARCHAR(50) UNIQUE NOT NULL,
    icon VARCHAR(50),
    description TEXT,
    parent_id UUID REFERENCES categories(id),
    sort_order INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_categories_parent ON categories(parent_id);
CREATE INDEX idx_categories_slug ON categories(slug);
```

### 3.4 æ ‡ç­¾è¡¨ (tags)

```sql
CREATE TABLE tags (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(50) UNIQUE NOT NULL,
    slug VARCHAR(50) UNIQUE NOT NULL,
    usage_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_tags_name ON tags(name);
CREATE INDEX idx_tags_usage_count ON tags(usage_count DESC);
```

### 3.5 æ¸¸æˆ-æ ‡ç­¾å…³è”è¡¨ (game_tags)

```sql
CREATE TABLE game_tags (
    game_id UUID REFERENCES games(id) ON DELETE CASCADE,
    tag_id UUID REFERENCES tags(id) ON DELETE CASCADE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (game_id, tag_id)
);

CREATE INDEX idx_game_tags_game ON game_tags(game_id);
CREATE INDEX idx_game_tags_tag ON game_tags(tag_id);
```

### 3.6 æ¸¸æˆåª’ä½“è¡¨ (game_media)

```sql
CREATE TABLE game_media (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    game_id UUID REFERENCES games(id) ON DELETE CASCADE,
    media_type VARCHAR(20) CHECK (media_type IN ('screenshot', 'video', 'trailer')),
    url VARCHAR(500) NOT NULL,
    thumbnail_url VARCHAR(500),
    sort_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_game_media_game ON game_media(game_id);
```

### 3.7 è¯„è®ºè¡¨ (comments)

```sql
CREATE TABLE comments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    game_id UUID REFERENCES games(id) ON DELETE CASCADE,
    rating INTEGER CHECK (rating >= 1 AND rating <= 5),
    content TEXT NOT NULL,
    images JSONB,  -- è¯„è®ºé…å›¾
    play_time INTEGER,  -- æ¸¸æˆæ—¶é•¿(å°æ—¶)
    helpful_count INTEGER DEFAULT 0,
    is_verified_purchase BOOLEAN DEFAULT FALSE,
    status VARCHAR(20) DEFAULT 'published' CHECK (status IN ('pending', 'published', 'hidden')),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_comments_user ON comments(user_id);
CREATE INDEX idx_comments_game ON comments(game_id);
CREATE INDEX idx_comments_created_at ON comments(created_at DESC);
CREATE INDEX idx_comments_helpful ON comments(helpful_count DESC);
```

### 3.8 è¯„è®ºå›å¤è¡¨ (comment_replies)

```sql
CREATE TABLE comment_replies (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    comment_id UUID REFERENCES comments(id) ON DELETE CASCADE,
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    content TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_comment_replies_comment ON comment_replies(comment_id);
CREATE INDEX idx_comment_replies_user ON comment_replies(user_id);
```

### 3.9 ç”¨æˆ·æ¸¸æˆåº“è¡¨ (user_game_library)

```sql
CREATE TABLE user_game_library (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    game_id UUID REFERENCES games(id) ON DELETE CASCADE,
    purchase_type VARCHAR(20) CHECK (purchase_type IN ('purchased', 'free', 'trial')),
    play_time INTEGER DEFAULT 0,  -- æ¸¸æˆæ—¶é•¿(åˆ†é’Ÿ)
    last_played TIMESTAMP,
    is_favorite BOOLEAN DEFAULT FALSE,
    achievements_unlocked INTEGER DEFAULT 0,
    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(user_id, game_id)
);

CREATE INDEX idx_library_user ON user_game_library(user_id);
CREATE INDEX idx_library_game ON user_game_library(game_id);
CREATE INDEX idx_library_last_played ON user_game_library(last_played DESC);
```

### 3.10 è®¢å•è¡¨ (orders)

```sql
CREATE TABLE orders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    order_number VARCHAR(50) UNIQUE NOT NULL,
    user_id UUID REFERENCES users(id) ON DELETE SET NULL,
    total_amount DECIMAL(10, 2) NOT NULL,
    discount_amount DECIMAL(10, 2) DEFAULT 0,
    final_amount DECIMAL(10, 2) NOT NULL,
    status VARCHAR(20) DEFAULT 'pending' CHECK (status IN ('pending', 'paid', 'cancelled', 'refunded')),
    payment_method VARCHAR(50),
    payment_id VARCHAR(100),
    payment_info JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    paid_at TIMESTAMP,
    cancelled_at TIMESTAMP,
    refunded_at TIMESTAMP
);

CREATE INDEX idx_orders_user ON orders(user_id);
CREATE INDEX idx_orders_number ON orders(order_number);
CREATE INDEX idx_orders_status ON orders(status);
CREATE INDEX idx_orders_created_at ON orders(created_at DESC);
```

### 3.11 è®¢å•é¡¹è¡¨ (order_items)

```sql
CREATE TABLE order_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    order_id UUID REFERENCES orders(id) ON DELETE CASCADE,
    game_id UUID REFERENCES games(id) ON DELETE SET NULL,
    game_title VARCHAR(200),
    price DECIMAL(10, 2) NOT NULL,
    quantity INTEGER DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_order_items_order ON order_items(order_id);
CREATE INDEX idx_order_items_game ON order_items(game_id);
```

### 3.12 è®ºå›æ¿å—è¡¨ (forum_sections)

```sql
CREATE TABLE forum_sections (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(100) NOT NULL,
    slug VARCHAR(100) UNIQUE NOT NULL,
    description TEXT,
    icon VARCHAR(50),
    parent_id UUID REFERENCES forum_sections(id),
    sort_order INTEGER DEFAULT 0,
    post_count INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_forum_sections_parent ON forum_sections(parent_id);
CREATE INDEX idx_forum_sections_slug ON forum_sections(slug);
```

### 3.13 å¸–å­è¡¨ (posts)

```sql
CREATE TABLE posts (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    author_id UUID REFERENCES users(id) ON DELETE CASCADE,
    section_id UUID REFERENCES forum_sections(id) ON DELETE CASCADE,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    images JSONB,
    tags VARCHAR(100)[],
    views INTEGER DEFAULT 0,
    likes INTEGER DEFAULT 0,
    reply_count INTEGER DEFAULT 0,
    is_pinned BOOLEAN DEFAULT FALSE,
    is_locked BOOLEAN DEFAULT FALSE,
    is_hidden BOOLEAN DEFAULT FALSE,
    last_reply_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_posts_author ON posts(author_id);
CREATE INDEX idx_posts_section ON posts(section_id);
CREATE INDEX idx_posts_created_at ON posts(created_at DESC);
CREATE INDEX idx_posts_last_reply ON posts(last_reply_at DESC NULLS LAST);
CREATE INDEX idx_posts_likes ON posts(likes DESC);
```

### 3.14 å¸–å­å›å¤è¡¨ (post_replies)

```sql
CREATE TABLE post_replies (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    post_id UUID REFERENCES posts(id) ON DELETE CASCADE,
    author_id UUID REFERENCES users(id) ON DELETE CASCADE,
    parent_id UUID REFERENCES post_replies(id),
    content TEXT NOT NULL,
    images JSONB,
    likes INTEGER DEFAULT 0,
    floor_number INTEGER,  -- æ¥¼å±‚å·
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_post_replies_post ON post_replies(post_id);
CREATE INDEX idx_post_replies_author ON post_replies(author_id);
CREATE INDEX idx_post_replies_parent ON post_replies(parent_id);
CREATE INDEX idx_post_replies_created_at ON post_replies(created_at);
```

### 3.15 å¥½å‹å…³ç³»è¡¨ (friendships)

```sql
CREATE TABLE friendships (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    friend_id UUID REFERENCES users(id) ON DELETE CASCADE,
    status VARCHAR(20) DEFAULT 'pending' CHECK (status IN ('pending', 'accepted', 'blocked')),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    accepted_at TIMESTAMP,
    UNIQUE(user_id, friend_id)
);

CREATE INDEX idx_friendships_user ON friendships(user_id);
CREATE INDEX idx_friendships_friend ON friendships(friend_id);
CREATE INDEX idx_friendships_status ON friendships(status);
```

### 3.16 é€šçŸ¥è¡¨ (notifications)

```sql
CREATE TABLE notifications (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    type VARCHAR(50) NOT NULL,  -- 'comment', 'like', 'friend_request', 'system'
    title VARCHAR(200),
    content TEXT,
    data JSONB,  -- é¢å¤–æ•°æ®
    is_read BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_notifications_user ON notifications(user_id);
CREATE INDEX idx_notifications_is_read ON notifications(is_read);
CREATE INDEX idx_notifications_created_at ON notifications(created_at DESC);
```

### 3.17 ä¸¾æŠ¥è¡¨ (reports)

```sql
CREATE TABLE reports (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    reporter_id UUID REFERENCES users(id) ON DELETE SET NULL,
    target_type VARCHAR(20) CHECK (target_type IN ('user', 'game', 'post', 'comment')),
    target_id UUID NOT NULL,
    report_type VARCHAR(50),  -- 'spam', 'harassment', 'inappropriate', etc.
    description TEXT,
    evidence JSONB,  -- è¯æ®æˆªå›¾
    status VARCHAR(20) DEFAULT 'pending' CHECK (status IN ('pending', 'processing', 'resolved', 'dismissed')),
    handler_id UUID REFERENCES users(id),
    handler_note TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    resolved_at TIMESTAMP
);

CREATE INDEX idx_reports_reporter ON reports(reporter_id);
CREATE INDEX idx_reports_target ON reports(target_type, target_id);
CREATE INDEX idx_reports_status ON reports(status);
```

## å››ã€æ•°æ®åº“åˆå§‹åŒ– SQL

```sql
-- åˆ›å»ºUUIDæ‰©å±•
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS "pgcrypto";

-- åˆ›å»ºæ›´æ–°æ—¶é—´è§¦å‘å™¨å‡½æ•°
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ language 'plpgsql';

-- ä¸ºéœ€è¦çš„è¡¨æ·»åŠ è§¦å‘å™¨
CREATE TRIGGER update_users_updated_at BEFORE UPDATE ON users
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_games_updated_at BEFORE UPDATE ON games
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_comments_updated_at BEFORE UPDATE ON comments
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_posts_updated_at BEFORE UPDATE ON posts
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
```

## äº”ã€åˆå§‹æ•°æ®

```sql
-- æ’å…¥é»˜è®¤ç®¡ç†å‘˜
INSERT INTO users (username, email, password_hash, role)
VALUES ('admin', 'admin@example.com', crypt('Admin123!', gen_salt('bf')), 'admin');

-- æ’å…¥æ¸¸æˆåˆ†ç±»
INSERT INTO categories (name, slug, icon, description) VALUES
('åŠ¨ä½œå†’é™©', 'action-adventure', 'ğŸ¯', 'åˆºæ¿€çš„åŠ¨ä½œå’Œå†’é™©æ¸¸æˆ'),
('è§£è°œç›Šæ™º', 'puzzle', 'ğŸ§©', 'è€ƒéªŒæ™ºåŠ›çš„è§£è°œæ¸¸æˆ'),
('ç¤¾äº¤äº’åŠ¨', 'social', 'ğŸ‘¥', 'å¤šäººç¤¾äº¤VRä½“éªŒ'),
('è¿åŠ¨å¥èº«', 'fitness', 'ğŸ’ª', 'VRè¿åŠ¨å’Œå¥èº«åº”ç”¨'),
('ææ€–æƒŠæ‚š', 'horror', 'ğŸ‘»', 'æƒŠæ‚šææ€–ç±»æ¸¸æˆ'),
('æ¨¡æ‹Ÿç»è¥', 'simulation', 'ğŸ—ï¸', 'æ¨¡æ‹Ÿå’Œç»è¥ç±»æ¸¸æˆ');

-- æ’å…¥è®ºå›æ¿å—
INSERT INTO forum_sections (name, slug, description, sort_order) VALUES
('å…¬å‘ŠåŒº', 'announcements', 'å¹³å°å…¬å‘Šå’Œæ´»åŠ¨ä¿¡æ¯', 1),
('ç»¼åˆè®¨è®º', 'general', 'æ¸¸æˆè¯„æµ‹ã€æ”»ç•¥å¿ƒå¾—', 2),
('å¼€å‘è€…ä¸“åŒº', 'developers', 'å¼€å‘è€…æŠ€æœ¯è®¨è®º', 3);
```

## å…­ã€æ•°æ®åº“å¤‡ä»½ç­–ç•¥

```bash
# æ¯æ—¥å¤‡ä»½è„šæœ¬
#!/bin/bash
BACKUP_DIR="/var/backups/postgres"
DB_NAME="vr_game_platform"
DATE=$(date +%Y%m%d_%H%M%S)

pg_dump -U postgres -d $DB_NAME | gzip > "$BACKUP_DIR/backup_$DATE.sql.gz"

# ä¿ç•™æœ€è¿‘30å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "backup_*.sql.gz" -mtime +30 -delete
```
